import * as Yup from "yup";
const F = (f) => !!(f && f === true);

export const loginSchema = (features) => {
  if (features.phoneOnly) {
    return Yup.object({ phone: Yup.string().required("Required") });
  }
  return Yup.object({
    email: Yup.string().email("Invalid email").required("Required"),
    password: Yup.string().min(6, "Min 6 chars").required("Required")
  });
};

export const signupSchema = (features) => {
  const f = features.signupFields || {};
  const shape = {};
  if (F(f.firstName)) shape.firstName = Yup.string().min(2,"Too short").required("Required");
  if (F(f.lastName))  shape.lastName  = Yup.string().min(2,"Too short").required("Required");
  if (F(f.email))     shape.email     = Yup.string().email("Invalid email").required("Required");
  if (F(f.phone))     shape.phone     = Yup.string().required("Required");
  if (F(f.dob))       shape.dob       = Yup.string().required("Required");
  if (F(f.password))  shape.password  = Yup.string().min(6,"Min 6 chars").required("Required");
  if (F(f.confirmPassword) && F(f.password)) {
    shape.confirmPassword = Yup.string().oneOf([Yup.ref("password")],"Passwords must match").required("Required");
  }
  return Yup.object(shape);
};
